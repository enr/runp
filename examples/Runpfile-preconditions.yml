name: Test Runpfile
description: This is Runpfile
units:
  win:
    description: Windows unit
    preconditions:
      os:
        inclusions:
          - windows
    host:
      command: dir {{vars runp_root}}
  unix:
    description: Nix unit
    preconditions:
      os:
        inclusions:
          - linux
          - darwin
    host:
      command: ls -al {{vars runp_root}}
  etchosts:
    description: Unit with /etc/hosts precondition
    preconditions:
      hosts:
        contains:
          127.0.1.1:
            - hop
    host:
      command: echo file /etc/hosts contains mapping "127.0.1.1 hop"
  envvars:
    description: Unit with environment variables precondition
    preconditions:
      env_vars:
        - name: DATABASE_URL
          condition: is_set
        - name: DEBUG_MODE
          condition: is_unset
        - name: NODE_ENV
          condition: is_equal
          value: "production"
        - name: API_KEY
          condition: is_equal
          value: "secret-key-123"
    host:
      command: echo all environment variable preconditions satisfied